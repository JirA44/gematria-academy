#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
1. Met √† jour le texte hero pour inclure TOUTES les disciplines
2. Ajoute une instruction F11 pour le plein √©cran
"""

import re

# Nouveau texte hero complet
NOUVEAU_TEXTE_HERO = "D√©couvrez les secrets ancestraux des civilisations anciennes : runes nordiques, gematria h√©bra√Øque, hi√©roglyphes √©gyptiens, glyphes mayas, mandalas sacr√©s et logiques. Un apprentissage progressif structur√© en trois niveaux de ma√Ætrise."

# Message F11 √† ajouter en haut de page
MESSAGE_F11 = '''        <div class="fullscreen-hint" style="background: linear-gradient(135deg, rgba(76, 175, 80, 0.2), rgba(33, 150, 243, 0.2)); border: 2px solid rgba(76, 175, 80, 0.5); border-radius: 15px; padding: 1rem 2rem; margin-bottom: 2rem; text-align: center; font-size: 1.1rem;">
            üí° <strong>Astuce :</strong> Appuyez sur <kbd style="background: rgba(255, 255, 255, 0.1); padding: 0.3rem 0.6rem; border-radius: 5px; border: 1px solid rgba(255, 255, 255, 0.3); font-family: monospace;">F11</kbd> pour profiter du site en plein √©cran !
        </div>
'''

def mettre_a_jour_fichier(fichier):
    """Met √† jour un fichier index avec le nouveau texte hero et le message F11"""
    print(f"\nüìù Traitement de {fichier}...")

    with open(fichier, 'r', encoding='utf-8') as f:
        contenu = f.read()

    modifie = False

    # 1. Mettre √† jour le texte hero dans le HTML
    pattern_html = r'<p[^>]*data-i18n="hero_text"[^>]*>.*?</p>'
    if re.search(pattern_html, contenu):
        contenu = re.sub(
            pattern_html,
            f'<p data-i18n="hero_text">{NOUVEAU_TEXTE_HERO}</p>',
            contenu
        )
        print("   ‚úì Texte hero HTML mis √† jour")
        modifie = True
    else:
        # Essayer sans data-i18n
        pattern_simple = r'<section class="hero">.*?<p>(.*?)</p>'
        if re.search(pattern_simple, contenu, re.DOTALL):
            contenu = re.sub(
                r'(<section class="hero">.*?<p>).*?(</p>)',
                f'\\1{NOUVEAU_TEXTE_HERO}\\2',
                contenu,
                flags=re.DOTALL
            )
            print("   ‚úì Texte hero HTML simple mis √† jour")
            modifie = True

    # 2. Mettre √† jour le texte hero dans les traductions JS (si pr√©sent)
    pattern_js = r'hero_text:\s*"[^"]+?"'
    if re.search(pattern_js, contenu):
        contenu = re.sub(
            pattern_js,
            f'hero_text: "{NOUVEAU_TEXTE_HERO}"',
            contenu
        )
        print("   ‚úì Texte hero JS (traductions) mis √† jour")
        modifie = True

    # 3. Ajouter le message F11 apr√®s <main>
    if MESSAGE_F11.strip() not in contenu:
        # Trouver <main> et ins√©rer juste apr√®s
        pattern_main = r'(<main>\s*)'
        if re.search(pattern_main, contenu):
            contenu = re.sub(
                pattern_main,
                f'\\1{MESSAGE_F11}\n',
                contenu
            )
            print("   ‚úì Message F11 ajout√©")
            modifie = True

    if modifie:
        with open(fichier, 'w', encoding='utf-8') as f:
            f.write(contenu)
        print(f"‚úÖ {fichier} mis √† jour avec succ√®s")
        return True
    else:
        print(f"‚ö†Ô∏è  {fichier} non modifi√© (patterns non trouv√©s)")
        return False

if __name__ == '__main__':
    print("üîß Mise √† jour du texte hero et ajout instruction F11...\n")

    fichiers = ['index.html', 'index_COMPLET.html', 'index_multilingual.html']
    fichiers_modifies = 0

    for fichier in fichiers:
        if mettre_a_jour_fichier(fichier):
            fichiers_modifies += 1

    print(f"\n‚ú® Termin√© !")
    print(f"   - {fichiers_modifies} fichiers mis √† jour")
    print(f"   - Nouveau texte : {NOUVEAU_TEXTE_HERO[:80]}...")
    print(f"   - Message F11 ajout√© en haut de page")
